import { requestBody } from "../functions/request-body";
import { getInstanceContainer } from "../functions/get-instance-container";
import { RxHttpResponse } from "./rx-http-response";
import { httpRequestContainer } from "../core/http-request-container";
import { Observable } from "rxjs";
var RxHttp = /** @class */ (function () {
    function RxHttp() {
    }
    RxHttp.prototype.getFilters = function () {
        var filters = (this._baseConfig && this._baseConfig.filters) ? this._baseConfig.filters : [];
        var filterService = this._serviceContainers.filter(function (t) { return t.type == "filter"; })[0];
        var requestFilters = [];
        if (filterService)
            filterService.config.forEach(function (t) { return requestFilters.push(t); });
        filters.forEach(function (t) { return requestFilters.push(t); });
        return requestFilters;
    };
    RxHttp.prototype.getInMemoryFilter = function () {
        var inMemory = this._serviceContainers.filter(function (t) { return t.type == "inmemory"; })[0];
        if (inMemory && this._baseConfig && this._baseConfig.filters)
            return this._baseConfig.filters.filter(function (t) { return t.isInMemory; })[0];
        return null;
    };
    RxHttp.prototype.request = function (method, config) {
        var _this = this;
        return new Observable(function (subscriber) {
            if (!_this._baseConfig)
                _this._baseConfig = httpRequestContainer.getConfig() || {};
            if (!_this._serviceContainers)
                _this._serviceContainers = getInstanceContainer(_this);
            var serviceContainer = _this._serviceContainers.filter(function (t) { return t.type == "http"; })[0];
            var request = requestBody(method, _this._baseConfig, serviceContainer, config, _this);
            if (request) {
                var error = _this._baseConfig ? _this._baseConfig.onError : null;
                var response = new RxHttpResponse(request, _this.getFilters(), _this.getInMemoryFilter(), _this.onError || error, _this.badRequest);
                response.process('subscribe', subscriber);
            }
            else {
                subscriber.next(null);
                subscriber.complete();
            }
        });
    };
    RxHttp.prototype.lookup = function (configs) {
        var _this = this;
        return new Observable(function (subscriber) {
            var propNames = [];
            var subscriptions = [];
            var jObject = {};
            configs.forEach(function (t) {
                propNames.push(t.propName);
                subscriptions.push(_this.get(t).subscribe(function (X) {
                    jObject[t.propName] = X;
                    if (Object.keys(jObject).length == propNames.length) {
                        subscriber.next(jObject);
                        subscriber.complete();
                    }
                }));
            });
        });
    };
    RxHttp.prototype.get = function (config) {
        return this.request('GET', config);
    };
    RxHttp.prototype.post = function (config) {
        return this.request('POST', config);
    };
    RxHttp.prototype.put = function (config) {
        return this.request('PUT', config);
    };
    RxHttp.prototype.patch = function (config) {
        return this.request('PATCH', config);
    };
    RxHttp.prototype.delete = function (config) {
        return this.request('DELETE', config);
    };
    return RxHttp;
}());
export { RxHttp };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicngtaHR0cC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0ByeHdlYi9odHRwLyIsInNvdXJjZXMiOlsiZG9tYWluL3J4LWh0dHAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHFDQUFxQyxDQUFDO0FBRTNFLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUV0RSxPQUFPLEVBQUUsVUFBVSxFQUEyQixNQUFNLE1BQU0sQ0FBQztBQUszRDtJQVVJO0lBRUEsQ0FBQztJQUVPLDJCQUFVLEdBQWxCO1FBQ0ksSUFBSSxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDN0YsSUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxJQUFJLElBQUksUUFBUSxFQUFsQixDQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0UsSUFBSSxjQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLElBQUksYUFBYTtZQUNiLGFBQWEsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO1FBQzlELE9BQU8sQ0FBQyxPQUFPLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUF0QixDQUFzQixDQUFDLENB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QU0sSUFBSSxTQUFTLENBQUMsTUFBTSxFQUFFO3dCQUNqRCxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO3dCQUN6QixVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7cUJBQ3pCO2dCQUNMLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDUixDQUFDLENBQUMsQ0FBQztRQUVQLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUdELG9CQUFHLEdBQUgsVUFBTyxNQUFtQztRQUN0QyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFRCxxQkFBSSxHQUFKLFVBQVEsTUFBc0M7UUFDMUMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRUQsb0JBQUcsR0FBSCxVQUFPLE1BQXNDO1FBQ3pDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVELHNCQUFLLEdBQUwsVUFBUyxNQUFzQztRQUMzQyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFRCx1QkFBTSxHQUFOLFVBQVUsTUFBc0M7UUFDNUMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBQ0wsYUFBQztBQUFELENBQUMsQUF6RkQsSUF5RkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwUmVxdWVzdENvbmZpZ30gZnJvbSBcIi4uL2ludGVyZmFjZS9odHRwLXJlcXVlc3QtY29uZmlnXCI7XHJcbmltcG9ydCB7IHJlcXVlc3RCb2R5IH0gZnJvbSBcIi4uL2Z1bmN0aW9ucy9yZXF1ZXN0LWJvZHlcIjtcclxuaW1wb3J0IHsgZ2V0SW5zdGFuY2VDb250YWluZXIgfSBmcm9tIFwiLi4vZnVuY3Rpb25zL2dldC1pbnN0YW5jZS1jb250YWluZXJcIjtcclxuaW1wb3J0IHsgU2VydmljZUNvbnRhaW5lckNvbmZpZyB9IGZyb20gXCIuLi9pbnRlcmZhY2Uvc2VydmljZS1jb250YWluZXItY29uZmlnXCI7XHJcbmltcG9ydCB7IFJ4SHR0cFJlc3BvbnNlIH0gZnJvbSBcIi4vcngtaHR0cC1yZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBodHRwUmVxdWVzdENvbnRhaW5lciB9IGZyb20gXCIuLi9jb3JlL2h0dHAtcmVxdWVzdC1jb250YWluZXJcIjtcclxuaW1wb3J0IHsgWGhyRmlsdGVyQ29uZmlnIH0gZnJvbSBcIi4uL2ludGVyZmFjZS94aHItZmlsdGVyLWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBmb3JrSm9pbiAsIFN1YnNjcmlwdGlvbiB9IGZyb20gXCJyeGpzXCI7XHJcbmltcG9ydCB7IEJhc2VIdHRwQ2xpZW50Q29uZmlnIH0gZnJvbSBcIi4uL2ludGVyZmFjZS9iYXNlLWh0dHAtY2xpZW50LWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBIdHRwUmVxdWVzdEJvZHlDb25maWcgfSBmcm9tIFwiLi4vaW50ZXJmYWNlL2h0dHAtcmVxdWVzdC1ib2R5LWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBMb29rdXBIdHRwUmVxdWVzdENvbmZpZyB9IGZyb20gXCIuLi9pbnRlcmZhY2UvbG9va3VwLWh0dHAtcmVxdWVzdC1jb25maWdcIjtcclxuaW1wb3J0IHsgSHR0cFJlc3BvbnNlIH0gZnJvbSAnLi4vbW9kZWxzJ1xyXG5leHBvcnQgY2xhc3MgUnhIdHRwIHtcclxuXHJcbiAgICBwYXRoOiBzdHJpbmc7XHJcblxyXG4gICAgcHJpdmF0ZSBfc2VydmljZUNvbnRhaW5lcnM6IFNlcnZpY2VDb250YWluZXJDb25maWdbXVxyXG4gICAgcHJpdmF0ZSBfYmFzZUNvbmZpZzogQmFzZUh0dHBDbGllbnRDb25maWc7XHJcblxyXG4gICAgb25FcnJvcjogKHJlc3BvbnNlOiBIdHRwUmVzcG9uc2UpID0+IHZvaWQ7XHJcbiAgICBiYWRSZXF1ZXN0OiAocmVzdWx0OiBhbnkpID0+IHZvaWQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RmlsdGVycygpIHtcclxuICAgICAgICBsZXQgZmlsdGVycyA9ICh0aGlzLl9iYXNlQ29uZmlnICYmIHRoaXMuX2Jhc2VDb25maWcuZmlsdGVycykgPyB0aGlzLl9iYXNlQ29uZmlnLmZpbHRlcnMgOiBbXTtcclxuICAgICAgICBsZXQgZmlsdGVyU2VydmljZSA9IHRoaXMuX3NlcnZpY2VDb250YWluZXJzLmZpbHRlcih0ID0+IHQudHlwZSA9PSBcImZpbHRlclwiKVswXTtcclxuICAgICAgICBsZXQgcmVxdWVzdEZpbHRlcnMgPSBbXTtcclxuICAgICAgICBpZiAoZmlsdGVyU2VydmljZSlcclxuICAgICAgICAgICAgZmlsdGVyU2VydmljZS5jb25maWcuZm9yRWFjaCh0ID0+IHJlcXVlc3RGaWx0ZXJzLnB1c2godCkpO1xyXG4gICAgICAgIGZpbHRlcnMuZm9yRWFjaCh0ID0+IHJlcXVlc3RGaWx0ZXJzLnB1c2godCkpO1xyXG4gICAgICAgIHJldHVybiByZXF1ZXN0RmlsdGVycztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEluTWVtb3J5RmlsdGVyKCk6IFhockZpbHRlckNvbmZpZyB7XHJcbiAgICAgICAgbGV0IGluTWVtb3J5ID0gdGhpcy5fc2VydmljZUNvbnRhaW5lcnMuZmlsdGVyKHQgPT4gdC50eXBlID09IFwiaW5tZW1vcnlcIilbMF07XHJcbiAgICAgICAgaWYgKGluTWVtb3J5ICYmIHRoaXMuX2Jhc2VDb25maWcgJiYgdGhpcy5fYmFzZUNvbmZpZy5maWx0ZXJzKVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFzZUNvbmZpZy5maWx0ZXJzLmZpbHRlcih0ID0+IHQuaXNJbk1lbW9yeSlbMF07XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZXF1ZXN0PFQ+KG1ldGhvZDogc3RyaW5nLCBjb25maWc6IEh0dHBSZXF1ZXN0Q29uZmlnIHwgSHR0cFJlcXVlc3RCb2R5Q29uZmlnIHwgc3RyaW5nKTogT2JzZXJ2YWJsZTxUPiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKHN1YnNjcmliZXIgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Jhc2VDb25maWcpXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYXNlQ29uZmlnID0gaHR0cFJlcXVlc3RDb250YWluZXIuZ2V0Q29uZmlnKCkgfHwge307XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5fc2VydmljZUNvbnRhaW5lcnMpXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXJ2aWNlQ29udGFpbmVycyA9IGdldEluc3RhbmNlQ29udGFpbmVyKHRoaXMpO1xyXG4gICAgICAgICAgICBsZXQgc2VydmljZUNvbnRhaW5lciA9IHRoaXMuX3NlcnZpY2VDb250YWluZXJzLmZpbHRlcih0ID0+IHQudHlwZSA9PSBcImh0dHBcIilbMF1cclxuICAgICAgICAgICAgbGV0IHJlcXVlc3QgPSByZXF1ZXN0Qm9keShtZXRob2QsIHRoaXMuX2Jhc2VDb25maWcsIHNlcnZpY2VDb250YWluZXIsIGNvbmZpZywgdGhpcyk7XHJcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZXJyb3IgPSB0aGlzLl9iYXNlQ29uZmlnID8gdGhpcy5fYmFzZUNvbmZpZy5vbkVycm9yIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IG5ldyBSeEh0dHBSZXNwb25zZShyZXF1ZXN0LCB0aGlzLmdldEZpbHRlcnMoKSwgdGhpcy5nZXRJbk1lbW9yeUZpbHRlcigpLCB0aGlzLm9uRXJyb3IgfHwgZXJyb3IsIHRoaXMuYmFkUmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5wcm9jZXNzKCdzdWJzY3JpYmUnLCBzdWJzY3JpYmVyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChudWxsKTtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgbG9va3VwPFQ+KGNvbmZpZ3M6IExvb2t1cEh0dHBSZXF1ZXN0Q29uZmlnW10pOiBPYnNlcnZhYmxlPFQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoc3Vic2NyaWJlciA9PiB7XHJcbiAgICAgICAgICAgIGxldCBwcm9wTmFtZXMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHN1YnNjcmlwdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IGpPYmplY3Q6YW55ID0ge307XHJcbiAgICAgICAgICAgIGNvbmZpZ3MuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgIHByb3BOYW1lcy5wdXNoKHQucHJvcE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuZ2V0KHQpLnN1YnNjcmliZShYID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBqT2JqZWN0W3QucHJvcE5hbWVdID0gWDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoak9iamVjdCkubGVuZ3RoID09IHByb3BOYW1lcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KGpPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldDxUPihjb25maWc/OiBIdHRwUmVxdWVzdENvbmZpZyB8IHN0cmluZyk6IE9ic2VydmFibGU8VD4gIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KCdHRVQnLCBjb25maWcpO1xyXG4gICAgfVxyXG5cclxuICAgIHBvc3Q8VD4oY29uZmlnOiBIdHRwUmVxdWVzdEJvZHlDb25maWcgfCBzdHJpbmcpOiBPYnNlcnZhYmxlPFQ+ICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnUE9TVCcsIGNvbmZpZyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHV0PFQ+KGNvbmZpZzogSHR0cFJlcXVlc3RCb2R5Q29uZmlnIHwgc3RyaW5nKTogT2JzZXJ2YWJsZTxUPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnUFVUJywgY29uZmlnKTtcclxuICAgIH1cclxuXHJcbiAgICBwYXRjaDxUPihjb25maWc6IEh0dHBSZXF1ZXN0Qm9keUNvbmZpZyB8IHN0cmluZyk6IE9ic2VydmFibGU8VD4gIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KCdQQVRDSCcsIGNvbmZpZyk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlPFQ+KGNvbmZpZzogSHR0cFJlcXVlc3RCb2R5Q29uZmlnIHwgc3RyaW5nKTogT2JzZXJ2YWJsZTxUPiAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ0RFTEVURScsIGNvbmZpZyk7XHJcbiAgICB9XHJcbn0iXX0=