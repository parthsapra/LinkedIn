import { HttpResponse } from '../models';
import { extractHeaders } from "../functions/util";
export class XhrRequest {
    constructor(request, onComplete, onRequestError, badRequest) {
        this.request = request;
        this.onComplete = onComplete;
        this.onRequestError = onRequestError;
        this.badRequest = badRequest;
        this.onLoad = () => {
            let response = new HttpResponse();
            response.statusCode = this.xhr.status;
            response.statusText = this.xhr.statusText || 'OK';
            response.headers = extractHeaders(this.xhr.getAllResponseHeaders());
            response.responseUrl = this.xhr.responseURL;
            let body = null;
            if (response.statusCode !== 204)
                body = typeof this.xhr.response === 'undefined' ? this.xhr.responseText : this.xhr.response;
            if (response.statusCode === 0)
                response.statusCode = !!body ? 200 : 0;
            let isSuccess = response.statusCode >= 200 && response.statusCode < 300;
            if (this.request.responseType === 'json' && response.headers["content-type"] && response.headers["content-type"].indexOf("json") != -1 && typeof body === 'string') {
                const originalBody = body;
                body = body.replace(/^\)\]\}',?\n/, '');
                try {
                    body = body !== '' ? JSON.parse(body) : null;
                }
                catch (ex) {
                    body = originalBody;
                    if (isSuccess) {
                        isSuccess = false;
                        body = { ex, body: body };
                    }
                }
            }
            response.body = body;
            if (isSuccess) {
                this.onComplete(response);
                this.dispose();
            }
            else
                this.onError(response);
        };
        this.onError = (error) => {
            if (this.xhr.status == 400 && this.badRequest)
                this.badRequest(typeof this.xhr.response === 'undefined' ? this.xhr.responseText : this.xhr.response);
            else if (this.onRequestError)
                this.onRequestError({
                    responseUrl: this.xhr.responseURL,
                    error: error,
                    statusCode: this.xhr.status || 0,
                    statusText: this.xhr.statusText || 'Unknown Error'
                });
            else
                console.error(error);
            this.dispose();
        };
        let xhr = new XMLHttpRequest();
        xhr.open(request.method, request.fullPath);
        Object.keys(request.headers).forEach(t => xhr.setRequestHeader(t, request.headers[t]));
        if (!request.headers['Accept'])
            xhr.setRequestHeader('Accept', 'application/json, text/plain, */*');
        if (!request.headers['Content-Type']) {
            const contentType = request.getContentType();
            if (contentType !== null) {
                xhr.setRequestHeader('Content-Type', contentType);
            }
        }
        xhr.addEventListener('load', this.onLoad);
        xhr.addEventListener('error', this.onError);
        xhr.withCredentials = true;
        xhr.send(request.serializeBody());
        this.xhr = xhr;
    }
    dispose() {
        if (this.xhr) {
            this.xhr.removeEventListener('load', this.onLoad);
            this.xhr.removeEventListener('error', this.onError);
        }
        this.xhr = null;
        this.request = null;
        this.onComplete = null;
        this.onRequestError = null;
        this.badRequest = null;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieGhyLXJlcXVlc3QuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Acnh3ZWIvaHR0cC8iLCJzb3VyY2VzIjpbImRvbWFpbi94aHItcmVxdWVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQWUsWUFBWSxFQUFDLE1BQU0sV0FBVyxDQUFBO0FBQ3BELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVuRCxNQUFNLE9BQU8sVUFBVTtJQUduQixZQUFvQixPQUFvQixFQUFVLFVBQW9CLEVBQVUsY0FBd0IsRUFBVSxVQUFvQjtRQUFsSCxZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBVTtRQUFVLG1CQUFjLEdBQWQsY0FBYyxDQUFVO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBVTtRQXVCdEksV0FBTSxHQUFHLEdBQUcsRUFBRTtZQUNWLElBQUksUUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7WUFDbEMsUUFBUSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQTtZQUNyQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQztZQUNsRCxRQUFRLENBQUMsT0FBTyxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLENBQUMsQ0FBQTtZQUNuRSxRQUFRLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDO1lBQzVDLElBQUksSUFBSSxHQUFRLElBQUksQ0FBQztZQUVyQixJQUFJLFFBQVEsQ0FBQyxVQUFVLEtBQUssR0FBRztnQkFDM0IsSUFBSSxHQUFHLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEtBQUssV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdB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dkIsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7UUFDM0IsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7SUFDM0IsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cFJlcXVlc3QsIEh0dHBSZXNwb25zZX0gZnJvbSAnLi4vbW9kZWxzJ1xyXG5pbXBvcnQgeyBleHRyYWN0SGVhZGVycyB9IGZyb20gXCIuLi9mdW5jdGlvbnMvdXRpbFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFhoclJlcXVlc3Qge1xyXG4gICAgeGhyOiBYTUxIdHRwUmVxdWVzdDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlcXVlc3Q6IEh0dHBSZXF1ZXN0LCBwcml2YXRlIG9uQ29tcGxldGU6IEZ1bmN0aW9uLCBwcml2YXRlIG9uUmVxdWVzdEVycm9yOiBGdW5jdGlvbiwgcHJpdmF0ZSBiYWRSZXF1ZXN0OiBGdW5jdGlvbikge1xyXG4gICAgICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC5mdWxsUGF0aCk7XHJcbiAgICAgICAgT2JqZWN0LmtleXMocmVxdWVzdC5oZWFkZXJzKS5mb3JFYWNoKHQgPT4geGhyLnNldFJlcXVlc3RIZWFkZXIodCwgcmVxdWVzdC5oZWFkZXJzW3RdKSk7XHJcblxyXG4gICAgICAgIGlmICghcmVxdWVzdC5oZWFkZXJzWydBY2NlcHQnXSlcclxuICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyonKTtcclxuXHJcbiAgICAgICAgaWYgKCFyZXF1ZXN0LmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRDb250ZW50VHlwZSgpO1xyXG4gICAgICAgICAgICBpZiAoY29udGVudFR5cGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCBjb250ZW50VHlwZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgdGhpcy5vbkxvYWQpO1xyXG4gICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XHJcbiAgICAgICAgeGhyLnNlbmQocmVxdWVzdC5zZXJpYWxpemVCb2R5KCkpO1xyXG5cclxuICAgICAgICB0aGlzLnhociA9IHhocjtcclxuICAgIH1cclxuXHJcbiAgICBvbkxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgbGV0IHJlc3BvbnNlID0gbmV3IEh0dHBSZXNwb25zZSgpO1xyXG4gICAgICAgIHJlc3BvbnNlLnN0YXR1c0NvZGUgPSB0aGlzLnhoci5zdGF0dXNcclxuICAgICAgICByZXNwb25zZS5zdGF0dXNUZXh0ID0gdGhpcy54aHIuc3RhdHVzVGV4dCB8fCAnT0snO1xyXG4gICAgICAgIHJlc3BvbnNlLmhlYWRlcnMgPSBleHRyYWN0SGVhZGVycyh0aGlzLnhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSlcclxuICAgICAgICByZXNwb25zZS5yZXNwb25zZVVybCA9IHRoaXMueGhyLnJlc3BvbnNlVVJMO1xyXG4gICAgICAgIGxldCBib2R5OiBhbnkgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSAhPT0gMjA0KVxyXG4gICAgICAgICAgICBib2R5ID0gdHlwZW9mIHRoaXMueGhyLnJlc3BvbnNlID09PSAndW5kZWZpbmVkJyA/IHRoaXMueGhyLnJlc3BvbnNlVGV4dCA6IHRoaXMueGhyLnJlc3BvbnNlO1xyXG5cclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gMClcclxuICAgICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9ICEhYm9keSA/IDIwMCA6IDA7XHJcblxyXG4gICAgICAgIGxldCBpc1N1Y2Nlc3MgPSByZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDwgMzAwO1xyXG4gICAgICAgIGlmICh0aGlzLnJlcXVlc3QucmVzcG9uc2VUeXBlID09PSAnanNvbicgJiYgcmVzcG9uc2UuaGVhZGVyc1tcImNvbnRlbnQtdHlwZVwiXSAmJiByZXNwb25zZS5oZWFkZXJzW1wiY29udGVudC10eXBlXCJdLmluZGV4T2YoXCJqc29uXCIpICE9IC0xICYmIHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBjb25zdCBvcmlnaW5hbEJvZHkgPSBib2R5O1xyXG4gICAgICAgICAgICBib2R5ID0gYm9keS5yZXBsYWNlKC9eXFwpXFxdXFx9Jyw/XFxuLywgJycpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgYm9keSA9IGJvZHkgIT09ICcnID8gSlNPTi5wYXJzZShib2R5KSA6IG51bGw7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICBib2R5ID0gb3JpZ2luYWxCb2R5O1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzU3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSB7IGV4LCBib2R5OiBib2R5IH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXNwb25zZS5ib2R5ID0gYm9keTtcclxuICAgICAgICBpZiAoaXNTdWNjZXNzKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25Db21wbGV0ZShyZXNwb25zZSlcclxuICAgICAgICAgICAgdGhpcy5kaXNwb3NlKClcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IocmVzcG9uc2UpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIG9uRXJyb3IgPSAoZXJyb3IpID0+IHtcclxuICAgICAgICBpZiAodGhpcy54aHIuc3RhdHVzID09IDQwMCAmJiB0aGlzLmJhZFJlcXVlc3QpXHJcbiAgICAgICAgICAgIHRoaXMuYmFkUmVxdWVzdCh0eXBlb2YgdGhpcy54aHIucmVzcG9uc2UgPT09ICd1bmRlZmluZWQnID8gdGhpcy54aHIucmVzcG9uc2VUZXh0IDogdGhpcy54aHIucmVzcG9uc2UpXHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5vblJlcXVlc3RFcnJvcilcclxuICAgICAgICAgICAgdGhpcy5vblJlcXVlc3RFcnJvcih7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZVVybDogdGhpcy54aHIucmVzcG9uc2VVUkwsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiB0aGlzLnhoci5zdGF0dXMgfHwgMCxcclxuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHRoaXMueGhyLnN0YXR1c1RleHQgfHwgJ1Vua25vd24gRXJyb3InXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgdGhpcy5kaXNwb3NlKCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGRpc3Bvc2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMueGhyKSB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCB0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIHRoaXMueGhyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5vbkVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy54aHIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucmVxdWVzdCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vbkNvbXBsZXRlID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9uUmVxdWVzdEVycm9yID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJhZFJlcXVlc3QgPSBudWxsO1xyXG4gICAgfVxyXG59Il19